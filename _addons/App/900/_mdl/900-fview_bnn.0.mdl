#!/bin/perl
# USE UTF-8 !!!
package Tomahawk::module;
use open ':utf8', ':std';
use if $] < 5.018, 'encoding','utf8';
use utf8;
use strict;


sub execute
{
 my %env=@_;
 #Tomahawk::GetXSGN(-convertvars=>1) || return undef; # NATIAHNEM XML DESIGN
 #Tomahawk::GetXLNG() || return undef; # NATIAHNEM XML LANGUAGE

 $env{db_900}=Tomahawk::Getmdlvar("900","db") unless $env{db_900};
 $env{db_900}=$TOM::DB_name unless $env{db_900};

 my $db0=$main::DBH->Query("
 	SELECT code
	FROM $env{db_900}.a900_bnn
	WHERE 	host='$tom::H'
		AND section='$env{section}'
		AND position='$env{position}'
		AND action='$env{action}'
		AND starttime<=$tom::time_current
		AND (endtime>=$tom::time_current OR endtime=0)
		AND type='$env{type}'
		AND (lng='$env{lng}' OR lng='')
		AND active='Y'
	LIMIT 1");
 if (my @db0_line=$db0->fetchrow)
 {
  $XSGN{TMP}=$db0_line[0];
 }
 else
 {
  $XSGN{TMP}="<!-- EMPTY BANNERCODE $tom::H-$env{section}-$env{position}-$env{type} --!>\n";
 }

 return 1}

1;
